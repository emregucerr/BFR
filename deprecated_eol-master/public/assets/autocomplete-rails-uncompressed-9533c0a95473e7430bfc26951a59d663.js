!function(e){e.fn.railsAutocomplete=function(){var t=function(){this.railsAutoCompleter||(this.railsAutoCompleter=new e.railsAutocomplete(this))};return void 0!==e.fn.on?$(document).on("focus",this.selector,t):this.live("focus",t)},e.railsAutocomplete=function(e){_e=e,this.init(_e)},e.railsAutocomplete.fn=e.railsAutocomplete.prototype={railsAutocomplete:"0.0.1"},e.railsAutocomplete.fn.extend=e.railsAutocomplete.extend=e.extend,e.railsAutocomplete.fn.extend({init:function(t){function n(e){return e.split(t.delimiter)}function s(e){return n(e).pop().replace(/^\s+/,"")}t.delimiter=e(t).attr("data-delimiter")||null,t.min_length=e(t).attr("data-min-length")||2,e(t).autocomplete({source:function(n,o){var r={term:s(n.term)};for(i in e(t).data())"include"==i.substr(0,7)&&(parameter=i.substr(7).toLowerCase(),r[parameter]=e(e(t).data(i)).val());e.getJSON(e(t).attr("data-autocomplete"),r,function(){0==arguments[0].length&&(arguments[0]=[],arguments[0][0]={id:"",label:"no existing match"}),e(arguments[0]).each(function(i,n){var s={};s[n.id]=n,e(t).data(s)}),o.apply(null,arguments)})},change:function(t,i){if(""!=e(e(this).attr("data-id-element")).val()){e(e(this).attr("data-id-element")).val(i.item?i.item.id:"");var n=e.parseJSON(e(this).attr("data-update-elements")),s=i.item?e(this).data(i.item.id.toString()):{};for(var o in n)e(n[o]).val(i.item?s[o]:"")}},search:function(){var e=s(this.value);return e.length<t.min_length?!1:void 0},focus:function(){return!1},select:function(i,s){var o=n(this.value);if(o.pop(),o.push(s.item.value),null!=t.delimiter)o.push(""),this.value=o.join(t.delimiter);else if(this.value=o.join(""),e(this).attr("data-id-element")&&e(e(this).attr("data-id-element")).val(s.item.id),e(this).attr("data-update-elements")){var r=e(this).data(s.item.id.toString()),a=e.parseJSON(e(this).attr("data-update-elements"));for(var l in a)e(a[l]).val(r[l])}var c=this.value;return e(this).bind("keyup.clearId",function(){e(this).val().trim()!=c.trim()&&(e(e(this).attr("data-id-element")).val(""),e(this).unbind("keyup.clearId"))}),e(t).trigger("railsAutocomplete.select",s),!1}})}}),e(document).ready(function(){e("input[data-autocomplete]").railsAutocomplete()})}(jQuery);