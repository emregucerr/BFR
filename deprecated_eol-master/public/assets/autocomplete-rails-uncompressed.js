!function(t){t.fn.railsAutocomplete=function(){var e=function(){this.railsAutoCompleter||(this.railsAutoCompleter=new t.railsAutocomplete(this))};return void 0!==t.fn.on?$(document).on("focus",this.selector,e):this.live("focus",e)},t.railsAutocomplete=function(t){_e=t,this.init(_e)},t.railsAutocomplete.fn=t.railsAutocomplete.prototype={railsAutocomplete:"0.0.1"},t.railsAutocomplete.fn.extend=t.railsAutocomplete.extend=t.extend,t.railsAutocomplete.fn.extend({init:function(e){function n(t){return t.split(e.delimiter)}function s(t){return n(t).pop().replace(/^\s+/,"")}e.delimiter=t(e).attr("data-delimiter")||null,e.min_length=t(e).attr("data-min-length")||2,t(e).autocomplete({source:function(n,a){var o={term:s(n.term)};for(i in t(e).data())"include"==i.substr(0,7)&&(parameter=i.substr(7).toLowerCase(),o[parameter]=t(t(e).data(i)).val());t.getJSON(t(e).attr("data-autocomplete"),o,function(){0==arguments[0].length&&(arguments[0]=[],arguments[0][0]={id:"",label:"no existing match"}),t(arguments[0]).each(function(i,n){var s={};s[n.id]=n,t(e).data(s)}),a.apply(null,arguments)})},change:function(e,i){if(""!=t(t(this).attr("data-id-element")).val()){t(t(this).attr("data-id-element")).val(i.item?i.item.id:"");var n=t.parseJSON(t(this).attr("data-update-elements")),s=i.item?t(this).data(i.item.id.toString()):{};for(var a in n)t(n[a]).val(i.item?s[a]:"")}},search:function(){var t=s(this.value);return t.length<e.min_length?!1:void 0},focus:function(){return!1},select:function(i,s){var a=n(this.value);if(a.pop(),a.push(s.item.value),null!=e.delimiter)a.push(""),this.value=a.join(e.delimiter);else if(this.value=a.join(""),t(this).attr("data-id-element")&&t(t(this).attr("data-id-element")).val(s.item.id),t(this).attr("data-update-elements")){var o=t(this).data(s.item.id.toString()),r=t.parseJSON(t(this).attr("data-update-elements"));for(var l in r)t(r[l]).val(o[l])}var c=this.value;return t(this).bind("keyup.clearId",function(){t(this).val().trim()!=c.trim()&&(t(t(this).attr("data-id-element")).val(""),t(this).unbind("keyup.clearId"))}),t(e).trigger("railsAutocomplete.select",s),!1}})}}),t(document).ready(function(){t("input[data-autocomplete]").railsAutocomplete()})}(jQuery);