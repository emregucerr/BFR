function clustersOnOff(){$("#goRadioText")[0].innerHTML="Clusters ON"==$("#goRadioText")[0].innerHTML?"Clusters OFF":"Clusters ON",EoLMap.change()}function get_center_lat_long(){var t=new google.maps.LatLngBounds;EoLMap.recs=data.records;for(var e=EoLMap.recs.length,i=0;e>i;i++)t.extend(new google.maps.LatLng(EoLMap.recs[i].h,EoLMap.recs[i].i));return t.getCenter()}var EoLMap={};EoLMap.recs=null,EoLMap.map=null,EoLMap.markerClusterer=null,EoLMap.markers=[],EoLMap.infoWindow=null;var markerSpiderfier=null,statuz=[],statuz_all=[],initial_map=!1;EoLMap.init=function(){center_latlong=get_center_lat_long();var t=new google.maps.LatLng(center_latlong.lat(),center_latlong.lng()),e={zoom:2,center:t,mapTypeId:google.maps.MapTypeId.ROADMAP,scaleControl:!0};EoLMap.map=new google.maps.Map($("#map-canvas")[0],e);{var i=document.createElement("div");new CenterControl(i,EoLMap.map,1)}i.index=1,i.style["padding-top"]="10px",EoLMap.map.controls[google.maps.ControlPosition.TOP_CENTER].push(i),EoLMap.recs=data.records,$("#total_markers")[0].innerHTML=data.actual+"<br>Plotted: "+data.count,EoLMap.map.enableKeyDragZoom();var n={keepSpiderfied:!0,event:"mouseover"};markerSpiderfier=new OverlappingMarkerSpiderfier(EoLMap.map,n),EoLMap.infoWindow=new google.maps.InfoWindow,EoLMap.showMarkers(),google.maps.event.addListener(EoLMap.map,"idle",function(){record_history()})},EoLMap.showMarkers=function(){EoLMap.markers=[],EoLMap.markerClusterer&&EoLMap.markerClusterer.clearMarkers();var t=$("#markerlist")[0];t.innerHTML="";for(var e=EoLMap.recs.length,i=0;e>i;i++){var n=EoLMap.recs[i].a;""===n&&(n="No catalog number");var s=document.createElement("DIV"),o=document.createElement("A");o.href="#",o.className="title",o.innerHTML=n,s.appendChild(o),t.appendChild(s);var a=new google.maps.LatLng(EoLMap.recs[i].h,EoLMap.recs[i].i),r=new google.maps.Marker({position:a,icon:"https://storage.googleapis.com/support-kms-prod/SNP_2752125_en_v0"}),l=EoLMap.markerClickFunction(EoLMap.recs[i],a);google.maps.event.addListener(r,"click",l),google.maps.event.addDomListener(o,"click",l),EoLMap.markers.push(r),markerSpiderfier.addMarker(r)}markerSpiderfier.addListener("click",function(t){EoLMap.infoWindow.open(EoLMap.map,t)}),markerx=EoLMap.markers,markerSpiderfier.addListener("spiderfy",function(){EoLMap.infoWindow.close()}),window.setTimeout(EoLMap.time,0)},EoLMap.markerClickFunction=function(t,e){return function(i){i.cancelBubble=!0,i.returnValue=!1,i.stopPropagation&&(i.stopPropagation(),i.preventDefault());var n=t.b,s='<div class="info"><h3>'+n+"</h3>";t.l&&(s+='<div class="info-body"><img src="'+t.l+'" class="info-img"/></div><br/>'),t.a&&(s+="Catalog number: "+t.a+"<br/>"),s+='Source portal: <a href="http://www.gbif.org/occurrence/'+t.g+'" target="_blank">GBIF data</a><br/>Publisher: <a href="http://www.gbif.org/publisher/'+t.d+'" target="_blank">'+t.c+'</a><br/>Dataset: <a href="http://www.gbif.org/dataset/'+t.f+'" target="_blank">'+t.e+"</a><br/>",t.j&&(s+="Recorded by: "+t.j+"<br/>"),t.k&&(s+="Identified by: "+t.k+"<br/>"),t.m&&(s+="Event date: "+t.m+"<br/>"),s+="</div>",EoLMap.infoWindow.setContent(s),EoLMap.infoWindow.setPosition(e),EoLMap.infoWindow.open(EoLMap.map)}},EoLMap.clear=function(){for(var t,e=0;t=EoLMap.markers[e];e++)t.setMap(null)},EoLMap.change=function(){EoLMap.clear(),EoLMap.showMarkers()},EoLMap.time=function(){if(document.getElementById("goRadioText"))if("Clusters ON"==$("#goRadioText")[0].innerHTML)EoLMap.markerClusterer=new MarkerClusterer(EoLMap.map,EoLMap.markers);else for(var t,e=0;t=EoLMap.markers[e];e++)t.setMap(EoLMap.map);else EoLMap.markerClusterer=new MarkerClusterer(EoLMap.map,EoLMap.markers)};