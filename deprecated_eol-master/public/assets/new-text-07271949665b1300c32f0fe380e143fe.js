EOL||(EOL={}),EOL.Text||(EOL.Text={}),EOL.Text.already_loaded||$.extend(EOL.Text,{already_loaded:!0,init_new_text_behaviors:function(){EOL.Text.form().unbind("submit"),EOL.Text.form().submit(function(){return EOL.Text.submit_text(),!1}),$("input#preview_text").unbind("click"),$("input#preview_text").on("click",function(){return EOL.Text.preview_text(this),!1}),$("#insert_text_popup a.close-button").unbind("click"),$("#insert_text_popup a.close-button").on("click",function(){return $("#insert_text_popup").slideUp(),EOL.Text.remove_preview(),!1}),$("input#cancel_edit_text").unbind("click"),$("input#cancel_edit_text").on("click",function(){return EOL.Text.cancel_edit(),!1}),$("select#data_objects_toc_category_toc_id").unbind("change"),$("select#data_objects_toc_category_toc_id").change(function(){$.ajax({url:$(this).data("change_toc_url"),success:function(e){EOL.Text.show_response_text_and_cleanup(e)},data:EOL.Text.form().serialize()})}),$("input#add_more_user_text_reference").unbind("click"),$("input#add_more_user_text_reference").on("click",function(){return $("#add_user_text_references_input").append('<textarea rows="3" name="references[]" id="references[]" cols="33"/>'),!1})},show_response_text_and_cleanup:function(e){$(".text_object").slideUp().delay(500).remove(),$("div.cpc-content div#unknown-text-warning-box_wrapper").slideUp().delay(500).remove(),$("div.cpc-content div#untrusted-text-warning-box_wrapper").slideUp().delay(500).remove(),$("#insert_text_popup").before(e),EOL.Text.init_edit_links()},show_missing_text_error_if_empty:function(){return textarea_val=$.trim($("textarea#data_object_description").val()),""===textarea_val?($("#missing_text_error").fadeIn().delay(2e3).fadeOut(),!0):!1},data_object_id:function(){return EOL.Text.form().data("data-object-id")},submit_text:function(){if(EOL.Text.show_missing_text_error_if_empty())return!1;var e=EOL.Text.data_object_id();$("#text_wrapper_"+e).slideUp().delay(500).remove(),EOL.Text.remove_preview(),$.ajax({url:EOL.Text.form().attr("action"),type:"POST",beforeSend:function(){EOL.Text.disable_form()},success:function(e){$("#insert_text_popup").before(e),EOL.Text.form().find("input, textarea").not(":hidden, :button, :submit").val("").removeAttr("checked").removeAttr("selected"),EOL.Text.init_edit_links(),EOL.Text.init_text_content_behaviors()},complete:function(){$("#insert_text_popup").slideUp()},error:function(){alert("Sorry, there was an error submitting your text.")},data:EOL.Text.form().serialize()})},preview_text:function(e){return EOL.Text.show_missing_text_error_if_empty()?!1:(EOL.Text.remove_preview(),$.ajax({url:$(e).data("preview_url"),type:"POST",beforeSend:function(){EOL.Text.disable_form()},success:function(e){$("#insert_text_popup").before(e),$("a#edit_text_").remove(),$("#text_wrapper_").slideDown()},complete:function(){EOL.Text.enable_form()},error:function(){alert("Sorry, there was an error previewing your text.")},data:EOL.Text.form().serialize().replace("_method=put&","id="+EOL.Text.data_object_id()+"&")}),void 0)},remove_preview:function(){$("div#text_wrapper_").slideUp(function(){$(this).remove()})},cancel_edit:function(){data_object_id=EOL.Text.data_object_id(),EOL.Text.remove_preview(),$("#text_wrapper_"+data_object_id).length>0||$("#original_toc_id").val()!=$("#data_objects_toc_category_toc_id").val()?($("#insert_text_popup").slideUp(),$("div#text_wrapper_"+data_object_id+"_popup").slideUp(1e3).delay(1100).remove()):($.ajax({url:$("#edit_data_object_"+data_object_id).attr("action").replace("/data_objects/","/data_objects/get/"),success:function(e){EOL.Text.show_response_text_and_cleanup(e)},data:EOL.Text.form.serialize()}),EOL.Text.disable_form())},disable_form:function(){EOL.Text.form().find("input[type=submit], input[type=button]").attr("disabled","disabled"),$("#edit_text_spinner").fadeIn()},enable_form:function(){EOL.Text.form().find("input[type=submit], input[type=button]").attr("disabled",""),$("#edit_text_spinner").fadeOut()}}),$(document).ready(function(){EOL.Text.init_new_text_behaviors()});